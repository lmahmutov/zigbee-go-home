{{define "layout"}}<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zigbee Home</title>
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <link rel="stylesheet" href="/static/style.css">
    {{if .APIKey}}<meta name="api-key" content="{{.APIKey}}">{{end}}
</head>
<body>
    <div class="app-layout">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <a href="/" class="sidebar-logo">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
                        <polyline points="9 22 9 12 15 12 15 22"/>
                    </svg>
                    <span>Zigbee Home</span>
                </a>
            </div>
            <nav class="sidebar-nav">
                <a href="/" class="nav-item" data-page="overview">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="3" width="7" height="7" rx="1"/>
                        <rect x="14" y="3" width="7" height="7" rx="1"/>
                        <rect x="3" y="14" width="7" height="7" rx="1"/>
                        <rect x="14" y="14" width="7" height="7" rx="1"/>
                    </svg>
                    <span data-i18n="nav.overview">Overview</span>
                </a>
                <a href="/devices" class="nav-item" data-page="devices">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="4" y="4" width="16" height="16" rx="2"/>
                        <rect x="9" y="9" width="6" height="6" rx="1"/>
                        <line x1="9" y1="2" x2="9" y2="4"/>
                        <line x1="15" y1="2" x2="15" y2="4"/>
                        <line x1="9" y1="20" x2="9" y2="22"/>
                        <line x1="15" y1="20" x2="15" y2="22"/>
                        <line x1="20" y1="9" x2="22" y2="9"/>
                        <line x1="20" y1="15" x2="22" y2="15"/>
                        <line x1="2" y1="9" x2="4" y2="9"/>
                        <line x1="2" y1="15" x2="4" y2="15"/>
                    </svg>
                    <span data-i18n="nav.devices">Devices</span>
                </a>
                <a href="/automations" class="nav-item" data-page="automations">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14.7 6.3a1 1 0 000 1.4l1.6 1.6a1 1 0 001.4 0l3.77-3.77a6 6 0 01-7.94 7.94l-6.91 6.91a2.12 2.12 0 01-3-3l6.91-6.91a6 6 0 017.94-7.94l-3.76 3.76z"/>
                    </svg>
                    <span data-i18n="nav.automations">Automations</span>
                </a>
                <a href="/network" class="nav-item" data-page="network">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M5 12.55a11 11 0 0114.08 0"/>
                        <path d="M1.42 9a16 16 0 0121.16 0"/>
                        <path d="M8.53 16.11a6 6 0 016.95 0"/>
                        <circle cx="12" cy="20" r="1"/>
                    </svg>
                    <span data-i18n="nav.network">Network</span>
                </a>
            </nav>
            <div class="sidebar-footer">
                <button class="sidebar-permit-join" id="sidebar-permit-join" onclick="permitJoin(120)">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="8" x2="12" y2="16"/>
                        <line x1="8" y1="12" x2="16" y2="12"/>
                    </svg>
                    <span data-i18n="nav.permit_join">Permit Join</span>
                </button>
                <div class="ws-badge" id="ws-badge">
                    <span class="ws-dot" id="ws-dot"></span>
                    <span class="ws-status-text" id="ws-status-text" data-i18n="nav.disconnected">Disconnected</span>
                </div>
                <button class="lang-toggle" id="lang-toggle" onclick="setLang(getLang()==='en'?'ru':'en')">RU</button>
                {{if .Version}}<div class="sidebar-version">v{{.Version}}</div>{{end}}
            </div>
        </aside>

        <!-- Mobile overlay -->
        <div class="mobile-overlay hidden" id="mobile-overlay" onclick="toggleSidebar()"></div>

        <!-- Main area -->
        <div class="main-area">
            <header class="topbar">
                <button class="btn-sidebar-toggle" onclick="toggleSidebar()" aria-label="Toggle sidebar">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="20" height="20">
                        <line x1="3" y1="6" x2="21" y2="6"/>
                        <line x1="3" y1="12" x2="21" y2="12"/>
                        <line x1="3" y1="18" x2="21" y2="18"/>
                    </svg>
                </button>
                <h1 class="topbar-title" id="topbar-title">{{.PageTitle}}</h1>
            </header>
            <main class="main-content">
                {{template "content" .}}
            </main>
        </div>
    </div>
    <div id="toast-container"></div>
    <script src="/static/i18n.js"></script>
    <script src="/static/app.js"></script>
</body>
</html>{{end}}
